{
    "KQLtables": [
        {
            "TableName": "SecurityEvent",
            "Purpose": "Stores Windows event log data from devices and servers. Commonly used for security-related logs such as logins, account management, and system auditing.",
            "KeyScenarios": ["Brute force detection", "Unauthorized access monitoring"],
            "Fields": ["EventID", "TimeGenerated", "Computer", "AccountName", "AccountDomain", "LogonType", "EventLevel", "Source"]
        },
        {
            "TableName": "SecurityAlert",
            "Purpose": "Contains data on security alerts generated by Azure Security Center, Microsoft Defender, and other integrated tools.",
            "KeyScenarios": ["Tracking and triaging alerts"],
            "Fields": ["TimeGenerated", "AlertName", "Severity", "Entity", "Description", "ProviderName", "Status"]
        },
        {
            "TableName": "SecurityIncident",
            "Purpose": "Tracks incidents, which are collections of related alerts.",
            "KeyScenarios": ["Incident response and analysis"],
            "Fields": ["IncidentNumber", "Title", "Severity", "Status", "Owner", "LastModifiedTime", "RelatedAlerts"]
        },
        {
            "TableName": "AzureDiagnostics",
            "Purpose": "Stores diagnostic logs from various Azure services like Application Gateway, Key Vault, or Azure Firewall.",
            "KeyScenarios": ["Monitoring Azure infrastructure for anomalies"],
            "Fields": ["ResourceId", "OperationName", "Category", "ResultType", "CallerIpAddress", "Message", "TimeGenerated"]
        },
        {
            "TableName": "AuditLogs",
            "Purpose": "Contains logs from Azure Active Directory (AAD) related to configuration changes and administrative activities.",
            "KeyScenarios": ["Monitoring privileged actions in Azure AD"],
            "Fields": ["Activity", "InitiatedBy", "Result", "Category", "CorrelationId", "TimeGenerated"]
        },
        {
            "TableName": "SignInLogs",
            "Purpose": "Stores user sign-in activity from Azure AD.",
            "KeyScenarios": ["Identifying suspicious sign-in behavior", "MFA bypass attempts"],
            "Fields": ["UserPrincipalName", "IPAddress", "Location", "ResultType", "AppDisplayName", "TimeGenerated"]
        },
        {
            "TableName": "OfficeActivity",
            "Purpose": "Contains Office 365 audit logs for activities such as file access, mailbox operations, and SharePoint activity.",
            "KeyScenarios": ["Tracking user activity in Office 365 applications"],
            "Fields": ["Operation", "UserId", "Workload", "ItemName", "ResultStatus", "TimeGenerated"]
        },
        {
            "TableName": "AADRiskyUsers",
            "Purpose": "Provides information on risky users detected by Azure AD Identity Protection.",
            "KeyScenarios": ["Identifying and mitigating account compromises"],
            "Fields": ["UserPrincipalName", "RiskLevel", "RiskState", "RiskDetail", "TimeGenerated"]
        },
        {
            "TableName": "AADRiskySignIns",
            "Purpose": "Provides information on risky sign-ins detected by Azure AD Identity Protection.",
            "KeyScenarios": ["Identifying and mitigating account compromises"],
            "Fields": ["UserPrincipalName", "IPAddress", "RiskLevel", "RiskState", "CorrelationId", "TimeGenerated"]
        },
        {
            "TableName": "Heartbeat",
            "Purpose": "Tracks the health and connectivity of connected agents.",
            "KeyScenarios": ["Monitoring system availability"],
            "Fields": ["Computer", "Category", "TimeGenerated", "OSName", "IPAddress"]
        },
        {
            "TableName": "AzureNetworkAnalytics_CL",
            "Purpose": "Stores logs related to Azure networking, such as traffic flow and Network Security Group (NSG) events.",
            "KeyScenarios": ["Analyzing network traffic for anomalies"],
            "Fields": ["TimeGenerated", "SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "Action", "Protocol"]
        },
        {
            "TableName": "DnsEvents",
            "Purpose": "Logs DNS query data from endpoints or servers.",
            "KeyScenarios": ["Detecting command-and-control (C2) communications"],
            "Fields": ["QueryName", "QueryType", "TimeGenerated", "ClientIP", "ServerIP"]
        },
        {
            "TableName": "AzureFirewall",
            "Purpose": "Stores logs from Azure Firewall, including allowed and denied traffic.",
            "KeyScenarios": ["Investigating network intrusions or misconfigurations"],
            "Fields": ["SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "Action", "Protocol", "TimeGenerated"]
        },
        {
            "TableName": "DeviceEvents",
            "Purpose": "Logs endpoint data from Microsoft Defender for Endpoint.",
            "KeyScenarios": ["Monitoring endpoint activity for malicious behavior"],
            "Fields": ["DeviceName", "EventTime", "EventName", "AccountName", "IPAddress", "ThreatName"]
        },
        {
            "TableName": "DeviceNetworkEvents",
            "Purpose": "Captures network traffic metadata from endpoints.",
            "KeyScenarios": ["Detecting lateral movement or unusual outbound traffic"],
            "Fields": ["DeviceName", "SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "Protocol", "TimeGenerated"]
        },
        {
            "TableName": "ThreatIntelligenceIndicator",
            "Purpose": "Stores threat intelligence feeds and indicators of compromise (IOCs).",
            "KeyScenarios": ["Enrichment of hunting queries with threat intelligence"],
            "Fields": ["IndicatorType", "IndicatorValue", "ThreatType", "Description", "LastUpdatedTime"]
        },
        {
            "TableName": "MalwareAssessmentEvents",
            "Purpose": "Logs malware events detected on endpoints.",
            "KeyScenarios": ["Investigating malware incidents"],
            "Fields": ["DeviceName", "MalwareName", "Severity", "ActionTaken", "DetectionSource", "TimeGenerated"]
        },
        {
            "TableName": "Syslog",
            "Purpose": "Stores syslog data from Linux/Unix devices or other systems supporting syslog forwarding.",
            "KeyScenarios": ["Monitoring and investigating activity on Linux servers"],
            "Fields": ["Host", "Facility", "Severity", "Message", "TimeGenerated"]
        },
        {
            "TableName": "CommonSecurityLog",
            "Purpose": "Generic log for security appliances like firewalls, IDS/IPS, and VPNs.",
            "KeyScenarios": ["Aggregated monitoring for non-Azure devices"],
            "Fields": ["SourceIP", "DestinationIP", "Action", "DeviceType", "Severity", "TimeGenerated"]
        },
        {
            "TableName": "CustomLogs",
            "Purpose": "Allows ingestion of custom log files.",
            "KeyScenarios": ["Custom data sources or unsupported log formats"],
            "Fields": ["LogFileName", "Message", "TimeGenerated", "CustomField1", "CustomField2"]
        },
        {
            "TableName": "Perf",
            "Purpose": "Logs performance data for monitored devices.",
            "KeyScenarios": ["Identifying performance bottlenecks or resource usage anomalies"],
            "Fields": ["Computer", "ObjectName", "CounterName", "CounterValue", "TimeGenerated"]
        },
        {
            "TableName": "Event",
            "Purpose": "Contains all types of events from connected devices.",
            "KeyScenarios": ["General hunting and query building"],
            "Fields": ["EventID", "TimeGenerated", "Computer", "EventLevel", "Message"]
        },
        {
            "TableName": "Alerts",
            "Purpose": "Consolidated alert data across different tools.",
            "KeyScenarios": ["Multi-source alert analysis"],
            "Fields": ["AlertName", "Severity", "Status", "Source", "TimeGenerated", "Entity"]
        },
        {
            "TableName": "Usage",
            "Purpose": "Provides information about the usage and costs of the Log Analytics workspace.",
            "KeyScenarios": ["Monitoring workspace health and cost management"],
            "Fields": ["TimeGenerated", "Solution", "DataUsage", "ResourceName", "SubscriptionId"]
        }
    ]
}